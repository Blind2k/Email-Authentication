(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{11:function(e,t,n){e.exports={header:"MainNavigation_header__VtfOg",nav:"MainNavigation_nav__1emo9",active:"MainNavigation_active__16ziw",logo_top:"MainNavigation_logo_top__3ebFT"}},12:function(e,t,n){e.exports={auth:"AuthForm_auth__2YYrg",control:"AuthForm_control__1gv-Q",actions:"AuthForm_actions__mlbFH",toggle:"AuthForm_toggle__cW_Oc"}},20:function(e,t,n){e.exports={profile:"UserProfile_profile__2Q-lt"}},21:function(e,t,n){e.exports={spinner:"LoadingSpinner_spinner__30ZXf"}},22:function(e,t,n){e.exports={starting:"StartingPageContent_starting__2OZly"}},27:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var c,o=n(14),i=n.n(o),r=n(8),a=(n(27),n(1)),s=n.n(a),l=n(2),j=n(11),u=n.n(j),d=n.p+"static/media/logo.5bf39f11.png",b=n(4),O=n(0),h=s.a.createContext({token:"",isLogged:!1,login:function(e){},logout:function(){}}),m=function(e){var t=(new Date).getTime();return new Date(e).getTime()-t},g=function(e){var t,n=function(){var e=localStorage.getItem("verificationToken"),t=localStorage.getItem("verificationTime"),n=m(t);return n<=3600||n<=0?(localStorage.removeItem("verificationToken"),localStorage.removeItem("verificationTime"),null):{token:e,duration:n}}();n&&(t=n.token);var o=Object(a.useState)(t),i=Object(b.a)(o,2),r=i[0],s=i[1],l=!!r,j=Object(a.useCallback)((function(){s(null),localStorage.removeItem("verificationToken"),localStorage.removeItem("verificationTime"),c&&clearTimeout(c)}),[]);Object(a.useEffect)((function(){n&&(console.log(n.duration),c=setTimeout(j,n.duration))}),[n,j]);var u={token:r,isLogged:l,login:function(e,t){s(e),localStorage.setItem("verificationToken",e),localStorage.setItem("verificationTime",t);var n=m(t);c=setTimeout(j,n)},logout:j};return Object(O.jsx)(h.Provider,{value:u,children:e.children})},f=h,x=function(){var e=Object(a.useContext)(f),t=e.isLogged;return Object(O.jsxs)("header",{className:u.a.header,children:[Object(O.jsx)(r.b,{to:"/",children:Object(O.jsx)("div",{children:Object(O.jsx)("img",{src:d,className:u.a.logo_top,alt:"Our logo"})})}),Object(O.jsx)("nav",{className:u.a.nav,children:Object(O.jsxs)("ul",{children:[!t&&Object(O.jsx)("li",{children:Object(O.jsx)(r.c,{activeClassName:u.a.active,to:"/auth",children:"Login"})}),t&&Object(O.jsx)("li",{children:Object(O.jsx)(r.c,{activeClassName:u.a.active,to:"/profile",children:"Profile"})}),t&&Object(O.jsx)("li",{children:Object(O.jsx)("button",{onClick:e.logout,children:Object(O.jsx)(r.b,{to:"/",children:"Logout"})})})]})})]})},p=function(e){return Object(O.jsxs)(a.Fragment,{children:[Object(O.jsx)(x,{}),Object(O.jsx)("main",{children:e.children})]})},v=n(9),_=n.n(v),S=(n(37),document.getElementById("overlays")),N=function(e){var t=e.isShowing,n=e.setHide,c=e.errorMessage;return t?i.a.createPortal(Object(O.jsxs)(s.a.Fragment,{children:[Object(O.jsx)("div",{className:"modal-overlay",onClick:n}),Object(O.jsx)("div",{className:"modal-wrapper","aria-modal":!0,"aria-hidden":!0,tabIndex:-1,role:"dialog",onClick:n,children:Object(O.jsxs)("div",{className:"modal",children:[Object(O.jsxs)("div",{className:"modal-header",children:[Object(O.jsx)("img",{src:d,className:"logo-error",alt:"Our logo"}),Object(O.jsx)("button",{type:"button",className:"modal-close-button","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("p",{className:"modal-text",children:c})]})})]}),S):null},k=function(){var e=Object(l.g)(),t=Object(a.useRef)(),n=Object(a.useContext)(f),c=Object(a.useState)(!1),o=Object(b.a)(c,2),i=o[0],r=o[1],s=Object(a.useState)(!1),j=Object(b.a)(s,2),u=j[0],d=j[1],h=Object(a.useState)(),m=Object(b.a)(h,2),g=m[0],x=m[1];return Object(O.jsxs)("form",{className:_.a.form,onSubmit:function(c){c.preventDefault();var o=t.current.value;" "!==o.trim()&&fetch("https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyC6dGNwU02TWzTJrXdA14s88P5FqjPH45g",{method:"POST",body:JSON.stringify({idToken:n.token,password:o,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();e.json().then((function(e){d(!0),x(e.error.message)}))})).then((function(t){r(!0),n.token=t.idToken,setTimeout((function(){e.replace("/")}),2e3)})).catch((function(e){console.log(e)}))},children:[i&&Object(O.jsx)(N,{errorMessage:"Password Change",setHide:function(){r((function(e){return!e}))},isShowing:i}),u&&Object(O.jsx)(N,{errorMessage:g,setHide:function(){d((function(e){return!e}))},isShowing:u}),Object(O.jsxs)("div",{className:_.a.control,children:[Object(O.jsx)("label",{htmlFor:"new-password",children:"New Password"}),Object(O.jsx)("input",{type:"password",id:"new-password",ref:t})]}),Object(O.jsx)("div",{className:_.a.action,children:Object(O.jsx)("button",{children:"Change Password"})})]})},T=function(){var e=Object(l.g)(),t=Object(a.useRef)(),n=Object(a.useContext)(f),c=Object(a.useState)(!1),o=Object(b.a)(c,2),i=o[0],r=o[1],s=Object(a.useState)(),j=Object(b.a)(s,2),u=j[0],d=j[1];return Object(O.jsxs)("form",{className:_.a.form,onSubmit:function(c){c.preventDefault();var o=t.current.value;""!==o.trim()&&fetch("https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyC6dGNwU02TWzTJrXdA14s88P5FqjPH45g",{method:"POST",body:JSON.stringify({idToken:n.token,email:o,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();e.json().then((function(e){r(!0),d(e.error.message)}))})).then((function(t){n.token=t.idToken,e.replace("/")})).catch((function(e){console.log(e)}))},children:[i&&Object(O.jsx)(N,{errorMessage:u,setHide:function(){r((function(e){return!e}))},isShowing:i}),Object(O.jsxs)("div",{className:_.a.control,children:[Object(O.jsx)("label",{htmlFor:"new-email",children:"New Email address"}),Object(O.jsx)("input",{type:"email",id:"new-email",ref:t})]}),Object(O.jsx)("div",{className:_.a.action,children:Object(O.jsx)("button",{children:"Change email"})})]})},w=n(20),y=n.n(w),C=function(){return Object(O.jsxs)("section",{className:y.a.profile,children:[Object(O.jsx)("h1",{children:"Your User Profile"}),Object(O.jsx)(k,{}),Object(O.jsx)(T,{})]})},P=n(21),F=n.n(P),I=function(){return Object(O.jsx)("div",{className:F.a.spinner})},A=n(12),H=n.n(A),z=function(){var e=Object(a.useState)(!1),t=Object(b.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(),i=Object(b.a)(o,2),r=i[0],s=i[1],j=Object(a.useState)(!1),u=Object(b.a)(j,2),d=u[0],h=u[1],m=Object(a.useState)(!1),g=Object(b.a)(m,2),x=g[0],p=g[1],v=Object(a.useRef)(),_=Object(a.useRef)(),S=Object(a.useContext)(f),k=Object(l.g)();return Object(O.jsxs)("section",{className:H.a.auth,children:[n&&Object(O.jsx)(N,{errorMessage:r,setHide:function(){c((function(e){return!e}))},isShowing:n}),Object(O.jsx)("h1",{children:d?"Login":"Sign Up"}),Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p(!0);var t,n=v.current.value,o=_.current.value;" "!==n.trim()&&(" "!==o.trim()&&(t=d?"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyC6dGNwU02TWzTJrXdA14s88P5FqjPH45g":"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyC6dGNwU02TWzTJrXdA14s88P5FqjPH45g",fetch(t,{method:"POST",body:JSON.stringify({email:n,password:o,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((function(e){if(p(!1),e.ok)return console.log("succed"),e.json();e.json().then((function(e){c(!0),s(e.error.message),console.log(e)}))})).then((function(e){var t=new Date((new Date).getTime()+1e3*+e.expiresIn);S.login(e.idToken,t.toISOString()),k.replace("/")})).catch((function(e){console.log("catch"+e)}))))},children:[Object(O.jsxs)("div",{className:H.a.control,children:[Object(O.jsx)("label",{htmlFor:"email",children:"Your Email"}),Object(O.jsx)("input",{ref:v,type:"email",id:"email",required:!0})]}),Object(O.jsxs)("div",{className:H.a.control,children:[Object(O.jsx)("label",{htmlFor:"password",children:"Your Password"}),Object(O.jsx)("input",{ref:_,type:"password",id:"password",required:!0})]}),x?Object(O.jsx)(I,{}):Object(O.jsxs)("div",{className:H.a.actions,children:[Object(O.jsx)("button",{children:d?"Login":"Create Account"}),Object(O.jsx)("button",{type:"button",className:H.a.toggle,onClick:function(){h((function(e){return!e}))},children:d?"Create new account":"Login with existing account"})]})]})]})},L=function(){return Object(O.jsx)(z,{})},M=n(22),J=n.n(M),U=function(){return Object(O.jsx)("section",{className:J.a.starting,children:Object(O.jsx)("h1",{children:"Welcome on Board!"})})},D=function(){return Object(O.jsx)(U,{})},W=s.a.lazy((function(){return n.e(3).then(n.bind(null,39))}));var q=function(){var e=Object(a.useContext)(f);return Object(O.jsx)(p,{children:Object(O.jsx)(a.Suspense,{fallback:Object(O.jsx)("div",{children:Object(O.jsx)(I,{})}),children:Object(O.jsxs)(l.d,{children:[Object(O.jsx)(l.b,{path:"/",exact:!0,children:Object(O.jsx)(D,{})}),Object(O.jsx)(l.b,{path:"/auth",children:Object(O.jsx)(L,{})}),Object(O.jsx)(l.b,{path:"/profile",children:e.isLogged?Object(O.jsx)(C,{}):Object(O.jsx)(l.a,{to:"auth"})}),Object(O.jsx)(l.b,{path:"*",children:Object(O.jsx)(W,{})})]})})})};i.a.render(Object(O.jsxs)(g,{children:[Object(O.jsx)(r.a,{children:Object(O.jsx)(q,{})}),","]}),document.getElementById("root"))},9:function(e,t,n){e.exports={form:"ProfileForm_form__3u3TM",control:"ProfileForm_control__UN0nv",action:"ProfileForm_action__BtH0Q"}}},[[38,1,2]]]);
//# sourceMappingURL=main.a6d06965.chunk.js.map